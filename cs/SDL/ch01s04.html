<?xml version="1.0" encoding="utf-8" standalone="no"?><html xmlns="http://www.w3.org/1999/xhtml"><head><title>What makes up a game</title><link href="epub.css" rel="stylesheet" type="text/css"/><meta content="DocBook XSL Stylesheets V1.75.2" name="generator"/>
<meta name="Adept.resource" value="urn:uuid:db9d31f0-c605-45e5-bd7f-8555ec3e9527"/></head><body id="page"><div class="section" title="What makes up a game"><div class="titlepage"><div><div><h1 class="title"><a id="ch01lvl1sec11"/>What makes up a game</h1></div></div></div><p>Outside the design and gameplay of a game, the underlying mechanics are essentially the interaction of various subsystems <a class="indexterm" id="id59"/>such as graphics, game logic, and user input. The graphics subsystem should not know how the game logic is implemented or vice versa. We can think of the structure of a game as follows:</p><div class="mediaobject"><img alt="What makes up a game" src="graphics/6821OT_01_08.jpg"/></div><p>Once the game is initialized, it then goes into a loop of checking for user input, updating any values based on the <a class="indexterm" id="id60"/>game physics, before rendering to the screen. Once the user chooses to exit, the loop is broken and the game moves onto cleaning everything up and exiting. This is the basic scaffold for a game and it is what will be used in this book.</p><p>We will be building a reusable framework that will take all of the legwork out of creating a game in SDL 2.0. When it comes to boilerplate code and setup code, we really only want to write it once and then reuse it within new projects. The same can be done with drawing code, event handling, map loading, game states, and anything else that all games may require. We will start by breaking up the Hello SDL 2.0 example into separate parts. This will help us to start thinking about how code can be broken into reusable standalone chunks rather than <a class="indexterm" id="id61"/>packing everything into one large file.</p><div class="section" title="Breaking up the Hello SDL code"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec13"/>Breaking up the Hello SDL code</h2></div></div></div><p>We can break up the Hello <a class="indexterm" id="id62"/>SDL into separate functions:</p><div class="informalexample"><pre class="programlisting">bool g_bRunning = false; // this will create a loop</pre></div><p>Follow these steps to break the <code class="literal">Hello SDL</code> code:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Create an <code class="literal">init</code> function after the two global variables that takes any necessary values as parameters and passes them to the <code class="literal">SDL_CreateWindow</code> function:<div class="informalexample"><pre class="programlisting">bool init(const char* title, int xpos, int ypos, int 
height, int width, int flags)
{
  // initialize SDL
  if(SDL_Init(SDL_INIT_EVERYTHING) &gt;= 0)
  {
    // if succeeded create our window
    g_pWindow = SDL_CreateWindow(title, xpos, ypos, 
    height, width, flags);

    // if the window creation succeeded create our 
    renderer
    if(g_pWindow != 0)
    {
      g_pRenderer = SDL_CreateRenderer(g_pWindow, -1, 0);
    }
  }
  else
  {
    return false; // sdl could not initialize
  }

  return true;
}

void render()
{
  // set to black
  SDL_SetRenderDrawColor(g_pRenderer, 0, 0, 0, 255);

  // clear the window to black
  SDL_RenderClear(g_pRenderer);

  // show the window
  SDL_RenderPresent(g_pRenderer);
}</pre></div></li><li class="listitem">Our main function can<a class="indexterm" id="id63"/> now use these functions to initialize SDL:<div class="informalexample"><pre class="programlisting">int main(int argc, char* argv[])
{
  if(init("Chapter 1: Setting up SDL", 
  SDL_WINDOWPOS_CENTERED, SDL_WINDOWPOS_CENTERED, 640, 
  480, SDL_WINDOW_SHOWN))
  {
    g_bRunning = true;
  }
  else
  {
    return 1; // something's wrong
  }

  while(g_bRunning)
  {
    render();
  }

  // clean up SDL
  SDL_Quit();

  return 0;
}</pre></div></li></ol></div><p>As you can see, we have broken the code up into separate parts: one function does the initialization for us and the other does the rendering code. We've added a way to keep the program running in the form of a <code class="literal">while</code> loop that runs continuously, rendering our window.</p><p>Let's take it a step further and try to identify which separate parts a full game might have and how our main loop might look. Referring to the first screenshot, we can see that the functions we will need<a class="indexterm" id="id64"/> are <code class="literal">initialize</code>, <code class="literal">get input</code>, <code class="literal">do physics</code>, <code class="literal">render</code>, and <code class="literal">exit</code>. We will generalize these functions slightly and rename them to <code class="literal">init()</code>, <code class="literal">handleEvents()</code>, <code class="literal">update()</code>, <code class="literal">render()</code>, and <code class="literal">clean()</code>. Let's put these functions into <code class="literal">main.cpp</code>:</p><div class="informalexample"><pre class="programlisting">void init(){}
void render(){}
void update(){}
void handleEvents(){}
void clean(){}

bool g_bRunning = true;

int main()
{
  init();

  while(g_bRunning)
  {
    handleEvents();
    update();
    render();
  }

  clean();
}</pre></div></div><div class="section" title="What does this code do?"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec14"/>What does this code do?</h2></div></div></div><p>This code does not do much at the moment, but it shows the bare bones of a game and how a main loop might be <a class="indexterm" id="id65"/>broken apart. We declare some functions that can be used to run our game: first, the <code class="literal">init()</code> function, which will initialize SDL and create our window, and second, we declare the core loop functions of <code class="literal">render</code>, <code class="literal">update</code>, and <code class="literal">handle events</code>. We also declare a<a class="indexterm" id="id66"/> <code class="literal">clean</code> function, which will clean up code at the end of our game. We want this loop to continue running so we have a Boolean value that is set to <code class="literal">true</code>, so that we can continuously call our core loop functions.</p></div></div></body></html>