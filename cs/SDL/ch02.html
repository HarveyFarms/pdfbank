<?xml version="1.0" encoding="utf-8" standalone="no"?><html xmlns="http://www.w3.org/1999/xhtml"><head><title>Chapter 2. Drawing in SDL</title><link href="epub.css" rel="stylesheet" type="text/css"/><meta content="DocBook XSL Stylesheets V1.75.2" name="generator"/>
<meta name="Adept.resource" value="urn:uuid:db9d31f0-c605-45e5-bd7f-8555ec3e9527"/></head><body id="page"><div class="chapter" title="Chapter 2. Drawing in SDL"><div class="titlepage"><div><div><h1 class="title"><a id="ch02"/>Chapter 2. Drawing in SDL</h1></div></div></div><p>Graphics are very important to games and they can also be one of the main performance bottlenecks if not handled correctly. With SDL 2.0 we can really take advantage of the GPU when rendering, which gives us a real boost in terms of the speed of rendering.</p><p>In this chapter we will cover:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">The basics of drawing with SDL</li><li class="listitem" style="list-style-type: disc">Source and destination rectangles</li><li class="listitem" style="list-style-type: disc">Loading and displaying textures</li><li class="listitem" style="list-style-type: disc">Using the <code class="literal">SDL_image</code> extension</li></ul></div><div class="section" title="Basic SDL drawing"><div class="titlepage"><div><div><h1 class="title"><a id="ch02lvl1sec14"/>Basic SDL drawing</h1></div></div></div><p>In the previous chapter we created an SDL window but we have yet to render anything to the screen. SDL can use two structures to draw to the screen. One is the <code class="literal">SDL_Surface</code> structure, which contains a <a class="indexterm" id="id107"/>collection of pixels and is rendered using<a class="indexterm" id="id108"/> software rendering processes (not the GPU). The other is <code class="literal">SDL_Texture</code>; this can be used for hardware-accelerated rendering. We want our games to be as efficient as possible so we will focus on using <code class="literal">SDL_Texture</code>.</p><div class="section" title="Getting some images"><div class="titlepage"><div><div><h2 class="title"><a id="ch02lvl2sec16"/>Getting some images</h2></div></div></div><p>We need some images to load throughout this chapter. We do not want to spend any time creating art assets for our games <a class="indexterm" id="id109"/>at this point; we want to focus entirely on the programming side. In this book we will use assets from the <code class="literal">SpriteLib</code> collection available at <a class="ulink" href="http://www.widgetworx.com/widgetworx/portfolio/spritelib.html">http://www.widgetworx.com/widgetworx/portfolio/spritelib.html</a>.</p><p>I have altered some of these files to allow us to easily use them in the upcoming chapters. These images are available with the source code download for this book. The first one we will use is the <code class="literal">rider.bmp</code> image file:</p><div class="mediaobject"><img alt="Getting some images" src="graphics/6821OT_02_01.jpg"/></div></div><div class="section" title="Creating an SDL texture"><div class="titlepage"><div><div><h2 class="title"><a id="ch02lvl2sec17"/>Creating an SDL texture</h2></div></div></div><p>First we will create a pointer to an <code class="literal">SDL_Texture</code> object as a member variable in our <code class="literal">Game.h</code> header file. We<a class="indexterm" id="id110"/> will also create some rectangles to be used when drawing the texture.</p><div class="informalexample"><pre class="programlisting">SDL_Window* m_pWindow;
SDL_Renderer* m_pRenderer;

SDL_Texture* m_pTexture; // the new SDL_Texture variable
SDL_Rect m_sourceRectangle; // the first rectangle
SDL_Rect m_destinationRectangle; // another rectangle</pre></div><p>We can load this texture in our game's <code class="literal">init</code> function for now. Open up <code class="literal">Game.cpp</code> and follow the steps to load and draw an <code class="literal">SDL_Texture</code>:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">First we will make an assets folder to hold our images, place this in the same folder as your source code (not the executable code). When you want to distribute the game you will copy this assets folder along with your executable. But for development purposes we will keep it in the same folder as the source code. Place the <code class="literal">rider.bmp</code> file into this assets folder.</li><li class="listitem">In our game's <code class="literal">init</code> function we can load our image. We will use the <code class="literal">SDL_LoadBMP</code> function which returns an <code class="literal">SDL_Surface*</code>. From this <code class="literal">SDL_Surface*</code> we can create <code class="literal">SDL_Texture</code> structure using the <code class="literal">SDL_CreateTextureFromSurface</code> function. We then free the temporary surface, releasing any used memory.<div class="informalexample"><pre class="programlisting">SDL_Surface* pTempSurface = SDL_LoadBMP("assets/rider.bmp");

m_pTexture = SDL_CreateTextureFromSurface(m_pRenderer, pTempSurface);

SDL_FreeSurface(pTempSurface);</pre></div></li><li class="listitem">We now have <code class="literal">SDL_Texture</code> ready to be drawn to the screen. We will first get the dimensions of the texture we have just loaded, and use them to set the width and height of <code class="literal">m_sourceRectangle</code> so that we can draw it correctly.<div class="informalexample"><pre class="programlisting">SDL_QueryTexture(m_pTexture, NULL, NULL, &amp;m_sourceRectangle.w, &amp;m_sourceRectangle.h);</pre></div></li><li class="listitem">Querying the texture will allow us to set the width and height of our source rectangle to the exact dimensions needed. So now that we have the correct height and width of <a class="indexterm" id="id111"/>our texture stored in <code class="literal">m_sourceRectangle</code> we must also set the destination rectangle's height and width. This is done so that our renderer knows which part of the window to draw our image to, and also the width and height of the image we want to render. We will set both x and y coordinates to <code class="literal">0</code> (top left). Window coordinates can be represented with an <code class="literal">x</code> and <code class="literal">y</code> value, with <code class="literal">x</code> being the horizontal position and <code class="literal">y</code> the vertical. Therefore the coordinates for the top-left of a window in SDL would be (0,0) and the center point would be the width of the window divided by two for <code class="literal">x</code>, and the height of the window divided by two for <code class="literal">y</code>.<div class="informalexample"><pre class="programlisting">m_destinationRectangle.x = m_sourceRectangle.x = 0;
m_destinationRectangle.y = m_sourceRectangle.y = 0;
m_destinationRectangle.w = m_sourceRectangle.w;
m_destinationRectangle.h = m_sourceRectangle.h;</pre></div></li><li class="listitem">Now that we have a loaded texture and its dimensions, we can move on to rendering it to the screen. Move to our game's <code class="literal">render</code> function and we will add the code to draw our texture. Put this function between the calls to <code class="literal">SDL_RenderClear</code> and <code class="literal">SDL_RenderPresent</code>.<div class="informalexample"><pre class="programlisting">SDL_RenderCopy(m_pRenderer, m_pTexture, &amp;m_sourceRectangle, &amp;m_destinationRectangle);</pre></div></li><li class="listitem">Build the project and you will see our loaded texture.<div class="mediaobject"><img alt="Creating an SDL texture" src="graphics/6821OT_02_02.jpg"/></div></li></ol></div></div></div></div></body></html>