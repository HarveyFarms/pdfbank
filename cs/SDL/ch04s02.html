<?xml version="1.0" encoding="utf-8" standalone="no"?><html xmlns="http://www.w3.org/1999/xhtml"><head><title>Creating fixed frames per second</title><link href="epub.css" rel="stylesheet" type="text/css"/><meta content="DocBook XSL Stylesheets V1.75.2" name="generator"/>
<meta name="Adept.resource" value="urn:uuid:db9d31f0-c605-45e5-bd7f-8555ec3e9527"/></head><body id="page"><div class="section" title="Creating fixed frames per second"><div class="titlepage"><div><div><h1 class="title"><a id="ch04lvl1sec22"/>Creating fixed frames per second</h1></div></div></div><p>Earlier in the book we put in an <code class="literal">SDL_Delay</code> function to slow everything down and ensure that our objects weren't moving too fast. We will now expand upon that by making our game run at a fixed frame rate. Fixed frames per second (FPS) is not necessarily always a good<a class="indexterm" id="id207"/> option, especially when your game includes more advanced physics. It is worth bearing this in mind when you move on from this book and start developing your own games. Fixed FPS will, however, be fine for the small 2D games, which <a class="indexterm" id="id208"/>we will work towards in this book. </p><p>With that said, let's move on to the code:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Open up <code class="literal">main.cpp</code> and we will create a few constant variables.<div class="informalexample"><pre class="programlisting">const int FPS = 60;
const int DELAY_TIME = 1000.0f / FPS;

int main()
{</pre></div></li><li class="listitem">Here we define how many frames per second we want our game to run at. A frame rate of 60 frames per second is a good starting point as this is essentially synced up to the refresh rate of most modern monitors and TVs. We can then divide this by the number of milliseconds in a second, giving us the amount of time we need to delay the game between loops to keep our constant frame rate. We need another two variables at the top of our main function; these will be used in our calculations.<div class="informalexample"><pre class="programlisting">int main()
{
    Uint32 frameStart, frameTime;</pre></div></li><li class="listitem">We can now implement our fixed frame rate in our main loop.<div class="informalexample"><pre class="programlisting">while(TheGame::Instance()-&gt;running())
{
  frameStart = SDL_GetTicks();

  TheGame::Instance()-&gt;handleEvents();
  TheGame::Instance()-&gt;update();
  TheGame::Instance()-&gt;render();

  frameTime = SDL_GetTicks() - frameStart;

  if(frameTime&lt; DELAY_TIME)
  {
    SDL_Delay((int)(DELAY_TIME - frameTime));
  }
}</pre></div></li></ol></div><p>First we get the time at the start of our loop and store it in <code class="literal">frameStart</code>. For this we use <code class="literal">SDL_GetTicks</code> which returns the amount of milliseconds since we called <code class="literal">SDL_Init</code>. We then run our game loop and store how long it took to run by subtracting the time our frame started from the current time. If it is less than the time we want a frame to take, we call <code class="literal">SDL_Delay</code> and make<a class="indexterm" id="id209"/> our loop wait for the amount of time we want it to, subtracting how long the loop already took to complete.</p></div></body></html>